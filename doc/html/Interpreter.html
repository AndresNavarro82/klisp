<html lang="en">
<head>
<title>Interpreter - klisp Reference Manual</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="klisp Reference Manual">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="prev" href="Introduction.html#Introduction" title="Introduction">
<link rel="next" href="Booleans.html#Booleans" title="Booleans">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
<link rel="stylesheet" type="text/css" href="css/style.css">
</head>
<body>
<div class="node">
<a name="Interpreter"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="Booleans.html#Booleans">Booleans</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="Introduction.html#Introduction">Introduction</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="index.html#Top">Top</a>
<hr>
</div>

<!-- node-name,  next,  previous,  up -->
<h2 class="chapter">2 Interpreter</h2>

<p><a name="index-interpreter-12"></a>
This section describes the <samp><span class="command">klisp</span></samp>, a Kernel Programming Language
stand-alone interpreter.

<h3 class="section">2.1 Invocation</h3>

<p><samp><span class="command">klisp</span></samp> is invoked like this:
<pre class="example">     klisp [options] [script]
</pre>
   <h3 class="section">2.2 Description</h3>

<p><samp><span class="command">klisp</span></samp> is a stand-alone klisp interpreter for the Kernel
Programming Language.  It loads and evaluates Kernel programs in
textual source form.  <samp><span class="command">klisp</span></samp> can be used as a batch
interpreter and also interactively.  The given <code>options</code>
(see <a href="Command-Line-Options.html#Command-Line-Options">Command Line Options</a>) are evaluated and then the klisp
program in file <code>script</code> is loaded and evaluated.  All
evaluations mentioned, including the initialization that is described
below, take place in the same (initially) standard environment. All
values that result from these evaluation are discarded, but if the
<code>root-continuation</code> or <code>error-continuation</code> are passed a
value, the evaluation of <code>options</code> is interrupted and
<samp><span class="command">klisp</span></samp> terminates. 
See <a href="Interpreter-Exit-Status.html#Interpreter-Exit-Status">Exit Status</a>, for a description of the
exit status in each case.

   <p>The string <code>script</code> together with all arguments are available as
a list of strings via the applicative <code>get-script-arguments</code>.  If
these arguments contain spaces or other characters special to the
shell, then they should be quoted (but note that the quotes will be
removed by the shell).  The complete command line, including the name
of the interpreter, options, the script, and its arguments are
available as a list of strings via the applicative
<code>get-interpreter-arguments</code>.

   <p>At the very beginning, before even handling the command line,
<samp><span class="command">klisp</span></samp> reads and evaluates the contents of the environment
variable <code>KLISP_INIT</code>, if it is defined.  To use an init file,
just define <code>KLISP_INIT</code> to the following form: <code>(load
"/path/to/init-file")</code>.  Notice that <samp><span class="command">klisp</span></samp> expects exactly one
expression in <code>KLISP_INIT</code>, if it is defined.  So it is an error
to have no expressions or more than one in <code>KLISP_INIT</code>.  The
same is true of the argument to the <code>-e</code> option, as both are
implemented in terms of <code>string-eval</code>. 
<!-- TODO add xref to string-eval -->

   <p>In interactive mode, <samp><span class="command">klisp</span></samp> prompts the user, reads
expressions from the standard input, and evaluates them as they are
read. The default prompt is "klisp&gt; ".

   <p><a name="Command-Line-Options"></a>

<h3 class="section">2.3 Options</h3>

<!-- @cindex Command Line Options -->
<!-- TODO move this to an appendix -->
<p>Options start with <samp><span class="option">-</span></samp> and are described below. You can use
<samp><span class="option">--</span></samp> to signal the end of options. If no arguments are given,
then <samp><span class="option">-v</span></samp>  <samp><span class="option">-i</span></samp> is assumed when the standard input is a
terminal; otherwise, <samp><span class="option">-</span></samp> is assumed.  If no <var>script</var>, or
option <samp><span class="option">-e</span></samp> or <code>-l</code> is given, <samp><span class="option">-i</span></samp> is assumed.

     <dl>
<dt><samp><span class="option">-</span></samp><dd><!-- TODO implement option index @opindex - ... -->
<!-- cindex ... -->
load and execute the standard input as a file,
that is,
not interactively,
even when the standard input is a terminal. 
.TP

     <br><dt><samp><span class="option">-e </span><var>expr</var></samp><dd><!-- @opindex -e ... -->
<!-- @cindex -e ... -->
evaluate expression <var>expr</var>.  You need to quote <var>expr</var> if it
contains spaces, quotes, or other characters special to the shell.

     <br><dt><samp><span class="option">-i</span></samp><dd><!-- @opindex -i ... -->
<!-- @cindex -i ... -->
enter interactive mode after <var>script</var> is executed.

     <br><dt><samp><span class="option">-l </span><var>name</var></samp><dd><!-- @opindex -l ... -->
<!-- @cindex -l ... -->
evaluate <code>(load "name")</code> before <var>script</var> is executed. 
Typically used to do environment initialization.

     <br><dt><samp><span class="option">-r </span><var>name</var></samp><dd><!-- @opindex -r ... -->
<!-- @cindex -r ... -->
evaluate <code>(require "name")</code> before <var>script</var> is
executed. Typically used to load libraries.

     <br><dt><samp><span class="option">-v</span></samp><dd><!-- @opindex -v ... -->
<!-- @cindex -v ... -->
show version and copyright information.

   </dl>

<!-- TODO move this to an appendix -->
   <p><a name="Interpreter-Exit-Status"></a>

<h3 class="section">2.4 Exit Status</h3>

<!-- @cindex Exit Status -->
<p>If the <var>script</var> or <samp><span class="file">stdin</span></samp> reach <var>EOF</var> or if there is no
<var>script</var>, <code>EXIT_SUCCESS</code> is returned.  If the
<var>error-continuation</var> is passed an object during init, arguments or script
evaluation <code>EXIT_FAILURE</code> is returned.  If the
<var>root-continuation</var> is passed an object, <samp><span class="command">klisp</span></samp> tries to
convert the value passed to the <var>root-continuation</var> to an exit
status as follows:

     <dl>
<dt><code>integer</code><dd>If the value is an integer it is used as exit status.

     <br><dt><code>boolean</code><dd>If the value is a boolean then <code>EXIT_SUCCESS</code> is returned for
<code>#t</code> and <code>EXIT_FAILURE</code> for <code>#f</code>.

     <br><dt><code>inert</code><dd>If the value is inert, then <code>EXIT_SUCCESS</code> is returned.

     <br><dt><code>else</code><dd>In any other case <code>EXIT_FAILURE</code> is returned. 
</dl>

<h3 class="section">2.5 Environment Variables</h3>

<!-- @cindex Interpreter Environment Variables -->
<p>The following environment variables affect the behaviour of <samp><span class="command">klisp</span></samp>

     <dl>
<dt><samp><span class="env">KLISP_INIT</span></samp><dd><!-- TODO index for env variables -->
A Kernel expression to be evaluated before any arguments to the
interpreter.  To use an init file, just define <var>KLISP_INIT</var> to the
following form <code>(load "/path/to/init-file")</code>

     <br><dt><samp><span class="env">KLISP_PATH</span></samp><dd>A semicolon separated list of templates for controlling the search of
required files.  Each template can use the char <code>?</code> to be
replaced by the required name at run-time.

   </dl>

<!-- *-texinfo-*- -->
   </body></html>

